<!-- 
  ALL-IN-ONE MARINE INSURANCE PORTAL
  This single file contains the UI for all 10 prompts.
  Navigation is handled by the `currentView` variable in the component.
-->
<div
  class="relative min-h-screen w-full bg-slate-50 font-sans text-slate-800"
>
  <!-- Main Container -->
  <div class="relative z-10 flex min-h-screen flex-col">
    <!-- Logged In Header -->
  <header
  *ngIf="isLoggedIn"
  class="sticky top-0 z-40 border-b border-slate-200/70 bg-white/80 shadow-sm backdrop-blur-sm"
>
  <!-- This container centers the content block with a max-width -->
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <!-- 
      This flex container arranges its children in a row.
      - 'justify-between': Pushes the first child to the start (left) and the last child to the end (right).
      - 'items-center': Vertically aligns the children in the middle.
    -->
    <div class="flex h-16 items-center justify-between">
      <!-- Left Side: Logo and Title -->
      <div class="flex items-center gap-4">
        <img
          src="https://geminialife.co.ke/wp-content/uploads/2022/06/thumbnail_GEMINIA-FINAL-LOGO-png.png"
          alt="Geminia Logo"
          class="h-10 w-auto"
        />
        <h1 class="text-xl font-semibold text-slate-800">Marine Portal</h1>
      </div>

      <!-- Right Side: Welcome Message and Logout Button -->
      <div class="flex items-center gap-4">
        <span class="hidden text-sm sm:inline"
          >Welcome,
          <span class="font-medium capitalize">{{ userRole }}</span></span
        >
        <button
          mat-stroked-button
          color="warn"
          (click)="logout()"
          class="!min-w-0 !border-red-500 !px-3 !text-red-500"
        >
          <mat-icon>logout</mat-icon>
          <span class="ml-2 hidden sm:inline">Logout</span>
        </button>
      </div>
    </div>
  </div>
</header>

    <!-- Main Content Area -->
    <main class="flex-1">
      <!-- 
        ======================================================================
        PROMPT 1: LOGIN PAGE
        ======================================================================
      -->
    <!-- Main container with a pleasant gradient background -->
<div
  *ngIf="currentView === 'login'"
  class="flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4"
  [@slideIn]
>
  <!-- Login card with shadow and rounded corners -->
  <div
    class="w-full max-w-md rounded-2xl border border-slate-200 bg-white p-8 shadow-lg"
  >
    <div class="mb-8 text-center">
      <!-- 
        SUGGESTION: Added h-16 and w-auto to control the logo size.
        Adjust the height (h-16) as needed.
      -->
      <img
        src="https://geminialife.co.ke/wp-content/uploads/2022/06/thumbnail_GEMINIA-FINAL-LOGO-png.png"
        alt="Geminia Logo"
        class="mx-auto mb-4 h-16 w-auto"
      />
      <h2 class="text-2xl font-bold text-slate-800">Marine Portal Login</h2>
      <p class="text-slate-500">Secure access for our trusted partners.</p>
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="login()" class="space-y-6">
      <!-- Email or Phone Field -->
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Email or Phone</mat-label>
        <input matInput formControlName="email" required />
        <mat-icon matSuffix>person</mat-icon>
        <!-- 
          SUGGESTION: Added mat-error for user feedback.
          This will show a message if the field is touched and left empty.
        -->
        <mat-error *ngIf="loginForm.get('email')?.hasError('required')">
          Email or Phone is required.
        </mat-error>
      </mat-form-field>

      <!-- Password Field -->
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Password / OTP</mat-label>
        <input matInput type="password" formControlName="password" required />
        <mat-icon matSuffix>lock</mat-icon>
        <!-- SUGGESTION: Added mat-error for user feedback -->
        <mat-error *ngIf="loginForm.get('password')?.hasError('required')">
          Password is required.
        </mat-error>
      </mat-form-field>

      <!-- Role Selection Field -->
      <mat-form-field appearance="outline" class="w-full">
        <mat-label>Role</mat-label>
        <mat-select formControlName="role" required>
          <mat-option value="intermediary">Intermediary</mat-option>
          <mat-option value="clearing_agent">Clearing Agent</mat-option>
          <mat-option value="admin">Admin</mat-option>
        </mat-select>
        <!-- SUGGESTION: Added mat-error for user feedback -->
        <mat-error *ngIf="loginForm.get('role')?.hasError('required')">
          Please select a role.
        </mat-error>
      </mat-form-field>

      <!-- Submit Button -->
      <button
        mat-flat-button
        color="primary"
        class="w-full !py-3 !text-base"
        type="submit"
        [disabled]="loginForm.invalid"
      >
        Secure Login
      </button>

      <!-- Link to Registration View -->
      <div class="text-center text-sm">
        <a
          (click)="setView('registration')"
          class="cursor-pointer font-medium text-blue-600 hover:underline"
          role="button"
          tabindex="0"
          >Don't have an account? Register</a
        >
      </div>
    </form>
  </div>
</div>

      <!-- 
        ======================================================================
        PROMPT 1: DASHBOARD VIEW
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'dashboard'"
        class="mx-auto max-w-7xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <h2 class="mb-6 text-3xl font-bold text-slate-800">Dashboard</h2>
        <!-- Quick Actions -->
        <div
          class="mb-8 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"
        >
          <button
            (click)="setView('coverSelection')"
            class="group flex items-center gap-4 rounded-xl border bg-white p-6 text-left shadow-sm transition hover:border-blue-500 hover:shadow-md"
          >
            <div
              class="flex h-12 w-12 items-center justify-center rounded-lg bg-blue-100 text-blue-600 transition group-hover:bg-blue-600 group-hover:text-white"
            >
              <mat-icon>add_circle</mat-icon>
            </div>
            <div>
              <h3 class="text-lg font-semibold">Get a New Quote</h3>
              <p class="text-sm text-slate-500">
                For Single Transit or Open Cover
              </p>
            </div>
          </button>
          <button
            (click)="setView('claims')"
            class="group flex items-center gap-4 rounded-xl border bg-white p-6 text-left shadow-sm transition hover:border-blue-500 hover:shadow-md"
          >
            <div
              class="flex h-12 w-12 items-center justify-center rounded-lg bg-blue-100 text-blue-600 transition group-hover:bg-blue-600 group-hover:text-white"
            >
              <mat-icon>warning</mat-icon>
            </div>
            <div>
              <h3 class="text-lg font-semibold">File a Claim</h3>
              <p class="text-sm text-slate-500">
                Start a new claim registration
              </p>
            </div>
          </button>
          <button
            (click)="setView('quoteRetrieval')"
            class="group flex items-center gap-4 rounded-xl border bg-white p-6 text-left shadow-sm transition hover:border-blue-500 hover:shadow-md"
          >
            <div
              class="flex h-12 w-12 items-center justify-center rounded-lg bg-blue-100 text-blue-600 transition group-hover:bg-blue-600 group-hover:text-white"
            >
              <mat-icon>history</mat-icon>
            </div>
            <div>
              <h3 class="text-lg font-semibold">View Policies & Quotes</h3>
              <p class="text-sm text-slate-500">
                Retrieve existing records
              </p>
            </div>
          </button>
        </div>
        <!-- Visual Counters -->
        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
          <div class="rounded-xl border bg-white p-6 shadow-sm">
            <div class="flex items-center justify-between">
              <p class="text-sm font-medium text-slate-500">
                Quotes Requested
              </p>
              <mat-icon class="text-green-500">request_quote</mat-icon>
            </div>
            <p class="mt-2 text-4xl font-bold">42</p>
          </div>
          <div class="rounded-xl border bg-white p-6 shadow-sm">
            <div class="flex items-center justify-between">
              <p class="text-sm font-medium text-slate-500">
                Active Policies
              </p>
              <mat-icon class="text-blue-500">shield</mat-icon>
            </div>
            <p class="mt-2 text-4xl font-bold">18</p>
          </div>
          <div class="rounded-xl border bg-white p-6 shadow-sm">
            <div class="flex items-center justify-between">
              <p class="text-sm font-medium text-slate-500">
                Pending Claims
              </p>
              <mat-icon class="text-amber-500">pending_actions</mat-icon>
            </div>
            <p class="mt-2 text-4xl font-bold">3</p>
          </div>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 2: REGISTRATION & ACTIVATION
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'registration'"
        class="flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4"
        [@slideIn]
      >
        <div
          class="w-full max-w-lg rounded-2xl border border-slate-200 bg-white p-8 shadow-lg"
        >
          <div *ngIf="!showOnboardingMessage">
            <h2 class="mb-2 text-2xl font-bold text-slate-800">
              Create Intermediary Account
            </h2>
            <p class="mb-6 text-slate-500">
              Join our network of trusted partners.
            </p>
            <form
              [formGroup]="registrationForm"
              (ngSubmit)="register()"
              class="space-y-4"
            >
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Full Name</mat-label>
                  <input matInput formControlName="fullName" />
                </mat-form-field>
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Phone Number</mat-label>
                  <input matInput formControlName="phone" />
                </mat-form-field>
              </div>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Email Address</mat-label>
                <input matInput formControlName="email" />
              </mat-form-field>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Password</mat-label>
                  <input
                    matInput
                    type="password"
                    formControlName="password"
                  />
                </mat-form-field>
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Confirm Password</mat-label>
                  <input
                    matInput
                    type="password"
                    formControlName="confirmPassword"
                  />
                </mat-form-field>
              </div>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Intermediary Code (Optional)</mat-label>
                <input matInput formControlName="intermediaryCode" />
              </mat-form-field>
              <div class="space-y-2 pt-2">
                <mat-checkbox formControlName="consent1" color="primary"
                  >I agree to the Terms of Service.</mat-checkbox
                >
                <mat-checkbox formControlName="consent2" color="primary"
                  >I agree to the Privacy Policy.</mat-checkbox
                >
                <mat-checkbox formControlName="consent3" color="primary"
                  >I consent to receive marketing communications.</mat-checkbox
                >
              </div>
              <button
                mat-flat-button
                color="primary"
                class="w-full !py-3 !text-base"
                type="submit"
                [disabled]="registrationForm.invalid"
              >
                Create Account
              </button>
              <div class="text-center text-sm">
                <a
                  (click)="setView('login')"
                  class="cursor-pointer font-medium text-blue-600 hover:underline"
                  >Already have an account? Login</a
                >
              </div>
            </form>
          </div>
          <!-- Onboarding Message -->
          <div *ngIf="showOnboardingMessage" class="text-center">
            <mat-icon
              class="!h-16 !w-16 text-green-500"
              >mark_email_read</mat-icon
            >
            <h2 class="mt-4 text-2xl font-bold">
              Registration Successful!
            </h2>
            <p class="mt-2 text-slate-600">
              Please check your email to activate your account. You will be
              redirected to the login page shortly.
            </p>
            <mat-progress-spinner
              class="mx-auto mt-6"
              mode="indeterminate"
              [diameter]="40"
            ></mat-progress-spinner>
          </div>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 3: MARINE COVER SELECTION
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'coverSelection'"
        class="mx-auto max-w-2xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="rounded-2xl border bg-white p-8 shadow-lg">
          <button
            mat-icon-button
            (click)="setView('dashboard')"
            class="absolute top-4 left-4"
          >
            <mat-icon>arrow_back</mat-icon>
          </button>
          <h2 class="mb-6 text-center text-2xl font-bold">
            Select Marine Cover
          </h2>
          <form
            [formGroup]="coverSelectionForm"
            (ngSubmit)="getQuote()"
            class="space-y-6"
          >
            <div>
              <label class="font-medium">Step 1: Select Account Type</label>
              <mat-form-field appearance="outline" class="mt-2 w-full">
                <mat-select
                  formControlName="accountType"
                  placeholder="Select your account type"
                >
                  <mat-option value="individual">Individual</mat-option>
                  <mat-option value="corporate">Corporate</mat-option>
                  <mat-option value="intermediary">Intermediary</mat-option>
                  <mat-option value="clearing_agent"
                    >Clearing Agent</mat-option
                  >
                </mat-select>
              </mat-form-field>
            </div>

            <div *ngIf="coverSelectionForm.get('accountType').value">
              <label class="font-medium">Step 2: Select Cover Type</label>
              <mat-radio-group
                formControlName="coverType"
                class="mt-2 flex flex-col gap-3"
              >
                <mat-radio-button value="single"
                  >Marine Single Transit</mat-radio-button
                >
                <mat-radio-button value="open"
                  >Marine Open Cover</mat-radio-button
                >
              </mat-radio-group>
            </div>

            <button
              mat-flat-button
              color="primary"
              class="w-full !py-3 !text-base"
              type="submit"
              [disabled]="!coverSelectionForm.get('coverType').value"
            >
              Get Quote
            </button>
          </form>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 4: QUOTATION FORM (SINGLE TRANSIT)
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'singleTransitQuote'"
        class="mx-auto max-w-7xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <button mat-stroked-button (click)="setView('coverSelection')">
          <mat-icon>arrow_back</mat-icon>
          Back to Cover Selection
        </button>
        <div class="mt-4 grid grid-cols-1 gap-8 lg:grid-cols-3">
          <!-- Form Section -->
          <div
            class="rounded-2xl border bg-white p-6 shadow-lg lg:col-span-2"
          >
            <h2 class="mb-6 text-2xl font-bold">
              Single Transit Quotation
            </h2>
            <form [formGroup]="singleTransitForm" class="space-y-4">
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Trade Type</mat-label>
                  <mat-select formControlName="tradeType">
                    <mat-option value="import">Import</mat-option>
                    <mat-option value="export">Export</mat-option>
                  </mat-select>
                </mat-form-field>
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Mode of Shipment</mat-label>
                  <mat-select formControlName="modeOfShipment">
                    <mat-option value="sea">Sea</mat-option>
                    <mat-option value="air">Air</mat-option>
                    <mat-option value="land">Land</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Origin</mat-label>
                  <input matInput formControlName="origin" />
                </mat-form-field>
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Destination</mat-label>
                  <input matInput formControlName="destination" />
                </mat-form-field>
              </div>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Description of Goods</mat-label>
                <input matInput formControlName="goodsDescription" />
              </mat-form-field>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Sum Insured</mat-label>
                  <input
                    matInput
                    type="number"
                    formControlName="sumInsured"
                  />
                </mat-form-field>
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>Currency</mat-label>
                  <mat-select formControlName="currency">
                    <mat-option value="KES">KES</mat-option>
                    <mat-option value="USD">USD</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>UCR Number</mat-label>
                  <input matInput formControlName="ucrNumber" />
                  <mat-icon
                    matSuffix
                    class="cursor-help"
                    matTooltip="Validated in real-time"
                    >verified</mat-icon
                  >
                </mat-form-field>
                <mat-form-field appearance="outline" class="w-full">
                  <mat-label>IDF Number</mat-label>
                  <input matInput formControlName="idfNumber" />
                </mat-form-field>
              </div>
              <div [formGroupName]="'addOns'">
                <h3 class="mb-2 font-medium">Optional Add-ons</h3>
                <div class="flex flex-wrap gap-4">
                  <mat-checkbox formControlName="war" color="primary"
                    >War</mat-checkbox
                  >
                  <mat-checkbox formControlName="sri_cc" color="primary"
                    >SRI & CC</mat-checkbox
                  >
                  <mat-checkbox formControlName="storage" color="primary"
                    >Storage</mat-checkbox
                  >
                </div>
              </div>
            </form>
          </div>

          <!-- Summary Sidebar -->
          <div class="lg:sticky lg:top-24">
            <div class="rounded-2xl border bg-white p-6 shadow-lg">
              <h3 class="mb-4 text-xl font-bold">Policy Summary</h3>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span class="text-slate-500">Premium</span>
                  <span class="font-medium"
                    >KES
                    {{ quoteSummary.premium | number: '1.2-2' }}</span
                  >
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Levies</span>
                  <span class="font-medium"
                    >KES {{ quoteSummary.levies | number: '1.2-2' }}</span
                  >
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Stamp Duty</span>
                  <span class="font-medium"
                    >KES
                    {{ quoteSummary.stampDuty | number: '1.2-2' }}</span
                  >
                </div>
                <div
                  class="flex justify-between border-t pt-2 text-lg font-bold"
                >
                  <span>Total</span>
                  <span
                    >KES {{ quoteSummary.total | number: '1.2-2' }}</span
                  >
                </div>
              </div>
              <div
                *ngIf="singleTransitForm.get('currency').value === 'USD'"
                class="mt-4 rounded-lg bg-blue-50 p-2 text-center text-xs text-blue-700"
              >
                FX Rate: 1 USD = 130.50 KES
              </div>
              <div class="mt-6 flex flex-col gap-3">
                <button
                  mat-flat-button
                  color="primary"
                  class="w-full !py-3"
                  (click)="buyNow(quoteSummary)"
                >
                  Buy Now
                </button>
                <div class="flex gap-3">
                  <button mat-stroked-button class="w-full">
                    <mat-icon>email</mat-icon> Email
                  </button>
                  <button mat-stroked-button class="w-full">
                    <mat-icon>whatsapp</mat-icon> WhatsApp
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 5: QUOTATION RETRIEVAL & EDIT
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'quoteRetrieval'"
        class="mx-auto max-w-2xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="rounded-2xl border bg-white p-8 shadow-lg">
          <button
            mat-icon-button
            (click)="setView('dashboard')"
            class="absolute top-4 left-4"
          >
            <mat-icon>arrow_back</mat-icon>
          </button>
          <h2 class="mb-6 text-center text-2xl font-bold">
            Retrieve Quote
          </h2>

          <!-- Retrieval Form -->
          <form
            *ngIf="!retrievedQuote"
            [formGroup]="quoteRetrievalForm"
            (ngSubmit)="retrieveQuote()"
            class="flex items-start gap-2"
          >
            <mat-form-field appearance="outline" class="flex-grow">
              <mat-label>Enter Reference Number</mat-label>
              <input matInput formControlName="reference" />
            </mat-form-field>
            <button
              mat-flat-button
              color="primary"
              type="submit"
              class="!h-[56px] !px-6"
            >
              Find
            </button>
          </form>

          <!-- Quote Summary -->
          <div *ngIf="retrievedQuote" [@slideIn]>
            <div
              class="mb-4 rounded-lg border p-4"
              [ngClass]="{
                                'border-red-200 bg-red-50': retrievedQuote.status === 'Expired',
                                'border-green-200 bg-green-50': retrievedQuote.status !== 'Expired'
                            }"
            >
              <div class="flex justify-between">
                <h3 class="font-bold">Quote {{ retrievedQuote.ref }}</h3>
                <span
                  class="rounded-full px-2 py-0.5 text-xs font-medium"
                  [ngClass]="{
                                        'bg-red-200 text-red-800': retrievedQuote.status === 'Expired',
                                        'bg-green-200 text-green-800': retrievedQuote.status !== 'Expired'
                                    }"
                  >{{ retrievedQuote.status }}</span
                >
              </div>
              <div class="mt-2 space-y-1 text-sm">
                <p>
                  Sum Insured:
                  <span class="font-medium"
                    >KES
                    {{ retrievedQuote.sumInsured | number }}</span
                  >
                </p>
                <p>
                  Premium:
                  <span class="font-medium"
                    >KES {{ retrievedQuote.premium | number }}</span
                  >
                </p>
                <p *ngIf="retrievedQuote.status === 'Expired'">
                  Expired On:
                  <span class="font-medium">{{
                    retrievedQuote.expiryDate
                  }}</span>
                </p>
              </div>
            </div>
            <div
              *ngIf="retrievedQuote.status === 'Expired'"
              class="mb-4 rounded-lg bg-amber-50 p-3 text-center text-sm text-amber-800"
            >
              <mat-icon class="!align-middle">warning</mat-icon>
              Rates are no longer locked. Regenerating may result in a
              different premium.
            </div>
            <div class="mt-6 flex flex-col gap-3 sm:flex-row">
              <button mat-stroked-button class="w-full">Edit Quote</button>
              <button mat-stroked-button class="w-full">
                Regenerate Quote
              </button>
              <button
                mat-flat-button
                color="primary"
                class="w-full"
                (click)="buyNow(retrievedQuote)"
              >
                Buy Now
              </button>
            </div>
            <button
              mat-button
              (click)="retrievedQuote = null"
              class="mx-auto mt-4 block"
            >
              Search for another quote
            </button>
          </div>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 6: OPEN COVER JOURNEY
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'openCoverQuote'"
        class="mx-auto max-w-2xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="rounded-2xl border bg-white p-8 shadow-lg">
          <button
            mat-icon-button
            (click)="setView('coverSelection')"
            class="absolute top-4 left-4"
          >
            <mat-icon>arrow_back</mat-icon>
          </button>
          <h2 class="mb-2 text-center text-2xl font-bold">
            Open Cover Declaration
          </h2>
          <p class="mb-6 text-center text-slate-500">
            Declare a new shipment under your open cover policy.
          </p>
          <div
            class="mb-4 rounded-lg bg-blue-50 p-3 text-center text-blue-800"
          >
            Credit Limit: <span class="font-bold">KES 5,000,000.00</span>
          </div>
          <form [formGroup]="openCoverForm" class="space-y-4">
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Contract Reference</mat-label>
              <input matInput formControlName="contractRef" />
            </mat-form-field>
            <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>IDF Number</mat-label>
                <input matInput formControlName="idf" />
              </mat-form-field>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>UCR Number</mat-label>
                <input matInput formControlName="ucr" />
              </mat-form-field>
            </div>
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Vessel / Flight No.</mat-label>
              <input matInput formControlName="vessel" />
            </mat-form-field>
            <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Shipment Date</mat-label>
                <input
                  matInput
                  [matDatepicker]="ocPicker"
                  formControlName="shipmentDate"
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="ocPicker"
                ></mat-datepicker-toggle>
                <mat-datepicker #ocPicker></mat-datepicker>
              </mat-form-field>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Cargo Value (KES)</mat-label>
                <input
                  matInput
                  type="number"
                  formControlName="cargoValue"
                />
              </mat-form-field>
            </div>
            <button
              mat-flat-button
              color="primary"
              class="w-full !py-3 !text-base"
              [disabled]="openCoverForm.invalid"
            >
              Submit Declaration
            </button>
          </form>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 7: PAYMENT PAGE
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'payment'"
        class="mx-auto max-w-4xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
          <div class="lg:col-span-2">
            <h2 class="mb-6 text-2xl font-bold">Complete Your Payment</h2>
            <mat-tab-group animationDuration="0ms">
              <mat-tab label="MPESA">
                <div class="p-6 text-center">
                  <h3 class="text-lg font-medium">Pay with MPESA</h3>
                  <p class="text-slate-500">
                    An STK push will be sent to your number.
                  </p>
                  <mat-form-field
                    appearance="outline"
                    class="mx-auto mt-4 max-w-sm"
                  >
                    <mat-label>Phone Number</mat-label>
                    <input matInput value="0712345678" />
                  </mat-form-field>
                  <button
                    mat-flat-button
                    color="primary"
                    class="mt-2 w-full max-w-sm !py-3"
                    (click)="submitPayment()"
                  >
                    Send STK Push
                  </button>
                </div>
              </mat-tab>
              <mat-tab label="Card Payment">
                <div class="space-y-4 p-6">
                  <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Card Number</mat-label>
                    <input matInput />
                  </mat-form-field>
                  <div class="grid grid-cols-2 gap-4">
                    <mat-form-field appearance="outline" class="w-full">
                      <mat-label>Expiry (MM/YY)</mat-label>
                      <input matInput />
                    </mat-form-field>
                    <mat-form-field appearance="outline" class="w-full">
                      <mat-label>CVV</mat-label>
                      <input matInput />
                    </mat-form-field>
                  </div>
                  <button
                    mat-flat-button
                    color="primary"
                    class="w-full !py-3"
                    (click)="submitPayment()"
                  >
                    Pay Now
                  </button>
                </div>
              </mat-tab>
              <mat-tab label="Credit Account">
                <div class="p-6 text-center">
                  <h3 class="text-lg font-medium">
                    Pay with Credit Account
                  </h3>
                  <p class="mt-4 text-slate-500">
                    Available Balance:
                    <span class="font-bold text-green-600"
                      >KES 250,000.00</span
                    >
                  </p>
                  <p class="text-slate-500">
                    This transaction will use
                    <span class="font-bold"
                      >KES {{ policyDetails?.premium | number }}</span
                    >
                    from your credit.
                  </p>
                  <button
                    mat-flat-button
                    color="primary"
                    class="mt-4 !py-3"
                    (click)="submitPayment()"
                  >
                    Confirm & Use Credit
                  </button>
                </div>
              </mat-tab>
            </mat-tab-group>
          </div>
          <!-- Payment Summary -->
          <div class="lg:sticky lg:top-24">
            <div class="rounded-2xl border bg-white p-6 shadow-lg">
              <h3 class="mb-4 text-xl font-bold">Policy Summary</h3>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span class="text-slate-500">Reference</span>
                  <span class="font-medium">{{ policyDetails?.ref }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-slate-500">Sum Insured</span>
                  <span class="font-medium"
                    >KES
                    {{ policyDetails?.sumInsured | number }}</span
                  >
                </div>
                <div
                  class="flex justify-between border-t pt-2 text-lg font-bold"
                >
                  <span>Total Payable</span>
                  <span
                    >KES {{ policyDetails?.premium | number }}</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 8: CERTIFICATE CONFIRMATION
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'confirmation'"
        class="mx-auto max-w-3xl p-4 text-center sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="rounded-2xl border bg-white p-8 shadow-lg">
          <div
            class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100"
          >
            <mat-icon class="!h-10 !w-10 text-green-600"
              >check_circle</mat-icon
            >
          </div>
          <h2 class="text-3xl font-bold">Payment Successful!</h2>
          <p class="mt-2 text-slate-500">
            Your policy is now active. Your documents are ready for
            download.
          </p>
          <div
            class="mt-6 rounded-lg bg-blue-50 p-3 text-sm text-blue-800"
          >
            An email with all documents has been sent to your registered
            address.
          </div>
          <div class="mt-6 space-y-2 border-t border-b py-4">
            <div class="flex justify-between">
              <span class="text-slate-500">Policy Status:</span>
              <span
                class="rounded-full bg-green-200 px-2 py-0.5 text-xs font-bold text-green-800"
                >PAID</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-slate-500">Certificate Number:</span>
              <span class="font-mono font-medium">AMI-54321</span>
            </div>
          </div>
          <div class="mt-8 flex flex-col gap-4 sm:flex-row">
            <button mat-stroked-button class="w-full !py-3">
              <mat-icon>picture_as_pdf</mat-icon> Certificate PDF
            </button>
            <button mat-stroked-button class="w-full !py-3">
              <mat-icon>receipt</mat-icon> Tax Invoice
            </button>
            <button mat-stroked-button class="w-full !py-3">
              <mat-icon>description</mat-icon> Schedule
            </button>
          </div>
          <button mat-flat-button color="primary" class="mt-4 w-full !py-3">
            Download All (.zip)
          </button>
          <button
            mat-button
            (click)="setView('dashboard')"
            class="mt-6"
          >
            Return to Dashboard
          </button>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 9: CLAIMS REGISTRATION
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'claims'"
        class="mx-auto max-w-3xl p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="rounded-2xl border bg-white p-8 shadow-lg">
          <h2 class="mb-4 text-center text-2xl font-bold">
            Register a New Claim
          </h2>
          <!-- Progress Bar -->
          <div class="mb-6">
            <mat-progress-bar
              mode="determinate"
              [value]="(claimStep / 4) * 100"
            ></mat-progress-bar>
            <div class="mt-2 flex justify-between text-xs">
              <span [class.font-bold]="claimStep >= 1">Details</span>
              <span [class.font-bold]="claimStep >= 2">Description</span>
              <span [class.font-bold]="claimStep >= 3">Documents</span>
              <span [class.font-bold]="claimStep >= 4">Confirmation</span>
            </div>
          </div>

          <form [formGroup]="claimsForm" (ngSubmit)="submitClaim()">
            <!-- Step 1 -->
            <div *ngIf="claimStep === 1" class="space-y-4" [@slideIn]>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Certificate Number</mat-label>
                <input matInput formControlName="certificateNumber" />
              </mat-form-field>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Date of Loss</mat-label>
                <input
                  matInput
                  [matDatepicker]="lossPicker"
                  formControlName="dateOfLoss"
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="lossPicker"
                ></mat-datepicker-toggle>
                <mat-datepicker #lossPicker></mat-datepicker>
              </mat-form-field>
              <button
                mat-flat-button
                color="primary"
                class="w-full !py-3"
                (click)="claimStep = 2"
              >
                Next: Description
              </button>
            </div>
            <!-- Step 2 -->
            <div *ngIf="claimStep === 2" class="space-y-4" [@slideIn]>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Location of Loss</mat-label>
                <input matInput formControlName="location" />
              </mat-form-field>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Description of Incident</mat-label>
                <textarea
                  matInput
                  rows="4"
                  formControlName="description"
                ></textarea>
              </mat-form-field>
              <div class="flex gap-4">
                <button
                  mat-stroked-button
                  class="w-full !py-3"
                  (click)="claimStep = 1"
                >
                  Back
                </button>
                <button
                  mat-flat-button
                  color="primary"
                  class="w-full !py-3"
                  (click)="claimStep = 3"
                >
                  Next: Documents
                </button>
              </div>
            </div>
            <!-- Step 3 -->
            <div *ngIf="claimStep === 3" class="space-y-4" [@slideIn]>
              <div
                class="flex h-32 w-full cursor-pointer items-center justify-center rounded-lg border-2 border-dashed border-slate-300 bg-slate-50 text-center"
              >
                <div>
                  <mat-icon class="text-slate-400">upload_file</mat-icon>
                  <p class="text-slate-500">
                    Click to upload documents
                  </p>
                </div>
              </div>
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Contact Person & Phone</mat-label>
                <input matInput formControlName="contactInfo" />
              </mat-form-field>
              <div class="flex gap-4">
                <button
                  mat-stroked-button
                  class="w-full !py-3"
                  (click)="claimStep = 2"
                >
                  Back
                </button>
                <button
                  mat-flat-button
                  color="primary"
                  class="w-full !py-3"
                  type="submit"
                >
                  Submit Claim
                </button>
              </div>
            </div>
          </form>
          <!-- Step 4 -->
          <div *ngIf="claimStep === 4" class="text-center" [@slideIn]>
            <mat-icon class="!h-16 !w-16 text-green-500"
              >check_circle</mat-icon
            >
            <h3 class="mt-4 text-2xl font-bold">Claim Registered</h3>
            <p class="mt-2 text-slate-600">
              Your claim has been successfully submitted.
            </p>
            <p class="mt-4 rounded-lg bg-slate-100 p-3 font-mono">
              Claim Reference: CLM-98765
            </p>
            <button
              mat-flat-button
              color="primary"
              class="mt-6"
              (click)="setView('dashboard')"
            >
              Return to Dashboard
            </button>
          </div>
        </div>
      </div>

      <!-- 
        ======================================================================
        PROMPT 10: ADMIN PORTAL
        ======================================================================
      -->
      <div
        *ngIf="currentView === 'adminDashboard'"
        class="bg-slate-100 p-4 sm:p-6 lg:p-8"
        [@slideIn]
      >
        <div class="mx-auto max-w-7xl">
          <div class="mb-6 flex flex-wrap items-center justify-between gap-4">
            <h2 class="text-3xl font-bold text-slate-800">Admin Panel</h2>
            <div class="flex gap-2">
              <button mat-stroked-button>
                <mat-icon>settings</mat-icon> Parameters
              </button>
              <button mat-flat-button color="primary">
                <mat-icon>assessment</mat-icon> Generate Report
              </button>
            </div>
          </div>
          <!-- KPIs -->
          <div
            class="mb-6 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3"
          >
            <div class="rounded-xl border bg-white p-6 shadow-sm">
              <p class="text-sm font-medium text-slate-500">
                Premiums Collected (Month)
              </p>
              <p class="mt-2 text-4xl font-bold">KES 1.2M</p>
            </div>
            <div class="rounded-xl border bg-white p-6 shadow-sm">
              <p class="text-sm font-medium text-slate-500">
                Claims Paid (Month)
              </p>
              <p class="mt-2 text-4xl font-bold">KES 450K</p>
            </div>
            <div class="rounded-xl border bg-white p-6 shadow-sm">
              <p class="text-sm font-medium text-slate-500">
                Total Risk Exposure
              </p>
              <p class="mt-2 text-4xl font-bold">KES 87M</p>
            </div>
          </div>
          <!-- Filters -->
          <div
            class="mb-6 grid grid-cols-1 gap-4 rounded-lg bg-white p-4 sm:grid-cols-2 lg:grid-cols-3"
            [formGroup]="adminFilterForm"
          >
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Filter by Date Range</mat-label>
              <mat-date-range-input [rangePicker]="adminPicker">
                <input
                  matStartDate
                  placeholder="Start date"
                  formControlName="startDate"
                />
                <input
                  matEndDate
                  placeholder="End date"
                  formControlName="endDate"
                />
              </mat-date-range-input>
              <mat-datepicker-toggle
                matSuffix
                [for]="adminPicker"
              ></mat-datepicker-toggle>
              <mat-date-range-picker #adminPicker></mat-date-range-picker>
            </mat-form-field>
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Filter by Status</mat-label>
              <mat-select formControlName="status">
                <mat-option value="paid">Paid</mat-option>
                <mat-option value="pending">Pending</mat-option>
                <mat-option value="expired">Expired</mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Filter by Account Type</mat-label>
              <mat-select formControlName="accountType">
                <mat-option value="intermediary">Intermediary</mat-option>
                <mat-option value="agent">Clearing Agent</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <!-- Table -->
          <div
            class="overflow-hidden rounded-lg border border-slate-200 bg-white"
          >
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-slate-200">
                <thead class="bg-slate-50">
                  <!-- Table headers -->
                </thead>
                <tbody class="divide-y divide-slate-200 bg-white">
                  <!-- Table rows -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>